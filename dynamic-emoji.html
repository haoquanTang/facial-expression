<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨æ€è¡¨æƒ…é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 119, 198, 0.2), transparent 50%),
                linear-gradient(135deg, #a8b5ff 0%, #6b73ff 25%, #9b59b6 50%, #8e44ad 75%, #6c5ce7 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            cursor: auto;
            transition: background 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .emoji-container {
            position: relative;
            width: 450px;
            height: 450px;
            cursor: auto;
            z-index: 20;
            margin: 0 auto;
        }

        .face {
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #ffeb3b 0%, #ffc107 30%, #ff9800 100%);
            border-radius: 50%;
            position: relative;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.25),
                0 10px 25px rgba(139, 69, 19, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: subtle-pop 0.5s cubic-bezier(0.22, 0.61, 0.36, 1) both;
        }

        .face:hover {
            transform: scale(1.05);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }

        /* é¢éƒ¨é«˜å…‰ä¸é˜´å½±å¢å¼ºå±‚æ¬¡æ„Ÿ */
        .face::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: 
                radial-gradient(ellipse at 30% 25%, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0.3) 25%, transparent 45%),
                radial-gradient(ellipse at 70% 25%, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.15) 20%, transparent 35%);
            pointer-events: none;
        }

        .face::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: 
                radial-gradient(ellipse at 50% 85%, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.06) 30%, transparent 50%),
                linear-gradient(to bottom, transparent 70%, rgba(0,0,0,0.05) 100%);
            pointer-events: none;
        }

        .eyes {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 75px;
        }

        .eye {
            width: 90px;
            height: 90px;
            background: radial-gradient(circle at 50% 60%, #ffffff 55%, #eef3f9 72%, #d9e2ec 90%);
            border-radius: 50%;
            position: relative;
            transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.18), 0 3px 9px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            will-change: transform;
        }

        /* é¡¶éƒ¨è½»é˜´å½±ï¼ˆçœ¼ç‘å‹å½±ï¼‰ */
        .eye::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.08), transparent 35%);
            pointer-events: none;
        }

        :root {
            /* è™¹è†œä¸»é¢˜é¢œè‰²ï¼ˆé»˜è®¤è“è‰²ï¼‰ */
            --iris-c1: #6ec3ff;
            --iris-c2: #328bd7;
            --iris-c3: #0b426f;
            /* åŠ¨ç”»é€Ÿåº¦ç³»æ•°ï¼ˆ1ä¸ºæ­£å¸¸ï¼Œç”¨æˆ·å¯è°ƒï¼‰ */
            --anim-speed: 1;
        }
        
        /* è™¹è†œä¸»é¢˜åˆ‡æ¢ */
        body[data-iris-theme="blue"] {
            --iris-c1: #6ec3ff;
            --iris-c2: #328bd7;
            --iris-c3: #0b426f;
        }
        
        body[data-iris-theme="green"] {
            --iris-c1: #7dd87d;
            --iris-c2: #4caf50;
            --iris-c3: #2e7d32;
        }
        
        body[data-iris-theme="brown"] {
            --iris-c1: #d4a574;
            --iris-c2: #8d6e63;
            --iris-c3: #5d4037;
        }
        
        body[data-iris-theme="gray"] {
            --iris-c1: #9e9e9e;
            --iris-c2: #616161;
            --iris-c3: #424242;
        }
        
        body[data-iris-theme="purple"] {
            --iris-c1: #ba68c8;
            --iris-c2: #8e24aa;
            --iris-c3: #4a148c;
        }
        
        body[data-iris-theme="amber"] {
            --iris-c1: #ffb74d;
            --iris-c2: #ff9800;
            --iris-c3: #e65100;
        }

        .iris {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 54px;
            height: 54px;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 30%, #4a4a4a 0%, #2a2a2a 40%, #1a1a1a 70%, #000 100%),
                conic-gradient(from 0deg, #333 0%, #444 25%, #222 50%, #555 75%, #333 100%),
                radial-gradient(circle at 50% 50%, var(--iris-c1) 0%, var(--iris-c2) 56%, var(--iris-c3) 92%);
            box-shadow: 
                inset 0 0 15px rgba(0,0,0,0.26),
                inset 0 0 12px rgba(0,0,0,0.6),
                inset 3px 3px 6px rgba(255,255,255,0.1);
            will-change: transform;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* è™¹è†œçº¹ç†ç»†èŠ‚ */
        .iris::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.8) 1px, transparent 2px),
                radial-gradient(circle at 75% 30%, rgba(255,255,255,0.6) 0.5px, transparent 1px),
                radial-gradient(circle at 40% 70%, rgba(255,255,255,0.4) 0.8px, transparent 1.5px),
                conic-gradient(from 45deg, transparent 0%, rgba(255,255,255,0.1) 10%, transparent 20%, rgba(255,255,255,0.05) 30%, transparent 40%);
            z-index: 3;
        }

        /* çœ¼ç›é«˜å…‰åå°„ */
        .iris::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 50%, transparent 100%);
            border-radius: 50%;
            top: 25%;
            left: 30%;
            z-index: 4;
            animation: eye-sparkle 3s ease-in-out infinite;
        }

        /* è‹¥æ”¯æŒ conic-gradientï¼Œåˆ™å¢å¼ºè™¹è†œçº¹ç†ä¸æš—ç¯ */
        @supports (background: conic-gradient(from 0deg, red, blue)) {
            .iris {
                background:
                    radial-gradient(circle at 50% 50%, transparent 62%, rgba(0,0,0,0.55) 64%, rgba(0,0,0,0.25) 70%, transparent 72%),
                    radial-gradient(circle at 50% 50%, transparent 0 34%, rgba(255,255,255,0.35) 34% 36%, transparent 36% 100%),
                    conic-gradient(from 0deg, rgba(0,0,0,0.18) 0 6deg, transparent 6deg 12deg),
                    conic-gradient(from 10deg, rgba(0,0,0,0.12) 0 8deg, transparent 8deg 16deg),
                    radial-gradient(circle at 50% 50%, var(--iris-c1) 0%, var(--iris-c2) 56%, var(--iris-c3) 92%);
                box-shadow: inset 0 0 10px rgba(0,0,0,0.35);
            }
        }

        /* å¤§é«˜å…‰ï¼ˆçœ¼ç¥å…‰ï¼‰ï¼Œä¸Šæ–¹æ¤­åœ† */
        .iris::after {
            content: '';
            position: absolute;
            top: -6px;
            left: 3px;
            width: 55%;
            height: 40%;
            background: radial-gradient(circle at 30% 35%, rgba(255,255,255,0.8) 0 45%, rgba(255,255,255,0.15) 55%, transparent 70%);
            border-radius: 50%;
            filter: blur(0.6px);
            transform: rotate(-8deg);
        }

        /* å†…éƒ¨å°é«˜å…‰ï¼ˆç‚¹å…‰ï¼‰ */
        .iris::before {
            content: '';
            position: absolute;
            top: 35%;
            left: 58%;
            width: 12px;
            height: 12px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            box-shadow: 0 0 9px rgba(255,255,255,0.55);
        }

        .pupil {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 21px;
            height: 21px;
            transform: translate(-50%, -50%) scale(var(--pupil-scale, 1));
            border-radius: 50%;
            background: radial-gradient(circle at 50% 50%, #111 0%, #000 70%);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.45);
        }

        /* é«˜å…‰ï¼ˆçœ¼çƒåå…‰ï¼‰ */
        .pupil::after {
            content: '';
            position: absolute;
            top: 12%;
            left: 18%;
            width: 9px;
            height: 9px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 50%;
            filter: blur(0.3px);
        }

        /* ä¸Šä¸‹çœ¼ç‘ï¼ˆä½¿ç”¨é¢éƒ¨é¢œè‰²è¦†ç›–ï¼Œå¸¦ç«æ¯›çº¿ï¼‰ */
        .lid {
            position: absolute;
            left: -10%;
            width: 120%;
            height: 60%;
            pointer-events: none;
            border-radius: 60% / 80%;
            transition: transform 220ms ease, box-shadow 220ms ease, background 220ms ease;
            background: linear-gradient(to bottom, rgba(255, 215, 0, 0.95), rgba(255, 215, 0, 0.9));
            will-change: transform;
        }

        .lid.upper {
            top: -35%;
            transform: translateY(-10%);
            border-bottom: 3px solid #000;
        }

        .lid.lower {
            bottom: -35%;
            transform: translateY(10%);
            border-top: 2px solid #000;
        }

        /* ä¸Šç«æ¯›ç»†èŠ‚ */
        .lid.upper::after {
            content: '';
            position: absolute;
            left: 6%;
            right: 6%;
            bottom: -2px;
            height: 6px;
            opacity: 0.25;
            background: repeating-linear-gradient(
                90deg,
                transparent 0 14px,
                rgba(0,0,0,0.6) 14px 15px
            );
        }

        .eyebrow {
            position: absolute;
            width: 75px;
            height: 9px;
            background: #000;
            border-radius: 5px;
            top: 25%;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform, height;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .eyebrow.left {
            left: 20%;
            transform: rotate(-15deg);
            transform-origin: center center;
        }

        .eyebrow.right {
            right: 20%;
            transform: rotate(15deg);
            transform-origin: center center;
        }

        .mouth {
            position: absolute;
            bottom: 22%;
            left: 50%;
            transform: translateX(-50%);
            width: 105px;
            height: 52px;
            border: 5px solid #000;
            border-top: none;
            border-radius: 0 0 105px 105px;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: transparent;
            will-change: transform;
        }

        /* å˜´å·´çŠ¶æ€æ ·å¼ */
        .mouth.neutral {
            width: 80px;
            height: 28px;
            border-radius: 0 0 80px 80px;
        }

        .mouth.happy {
            width: 135px;
            height: 68px;
            border-radius: 0 0 135px 135px;
            background: linear-gradient(to bottom, rgba(255,192,203,0.3), rgba(255,182,193,0.5));
            animation: mouthPulse 2.5s ease-in-out infinite;
            transform: translateX(-50%) scale(1.05);
            box-shadow: inset 0 -4px 9px rgba(0,0,0,0.1);
            border-width: 6px;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .mouth.angry {
            width: 68px;
            height: 12px;
            background: #333;
            border-radius: 3px;
            transform: translateX(-50%) rotate(-5deg);
            border: none;
        }

        /* å˜´å·´å¼ºåº¦å˜åŒ– */
        .mouth.intensity-low {
            transform: translateX(-50%) scale(0.85);
            opacity: 0.8;
        }

        .mouth.intensity-medium {
            transform: translateX(-50%) scale(1);
            opacity: 0.9;
        }

        .mouth.intensity-high {
            transform: translateX(-50%) scale(1.1);
            opacity: 1;
            filter: brightness(1.1);
        }

        .mouth.happy.intensity-high {
            transform: translateX(-50%) scale(1.15);
            height: 72px;
            border-radius: 0 0 135px 135px;
        }

        .mouth.sad.intensity-high {
            height: 38px;
            transform: translateX(-50%) rotate(180deg) scale(1.1);
        }

        .mouth.surprised.intensity-high {
            width: 28px;
            height: 38px;
            border-radius: 50%;
        }

        .mouth.surprised {
            width: 32px;
            height: 45px;
            border: 4px solid #333;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.6) 100%);
            animation: mouthShake 0.5s ease-in-out infinite;
        }

        .mouth.sad {
            width: 68px;
            height: 34px;
            border: 4px solid #333;
            border-bottom: none;
            border-radius: 68px 68px 0 0;
            background: transparent;
            transform: translateX(-50%) rotate(180deg);
        }

        .mouth.laugh {
            width: 145px;
            height: 75px;
            border-radius: 0 0 145px 145px;
            background: transparent;
            animation: mouthBounce 0.9s ease-in-out infinite;
            overflow: hidden;
            border-width: 6px;
        }

        .mouth.laugh::before {
            content: '';
            position: absolute;
            left: 18px;
            right: 18px;
            top: 0;
            height: 30px;
            background: linear-gradient(to bottom, #fff 0%, #f8f8f8 100%);
            border-bottom: 6px solid #000;
            border-radius: 0 0 15px 15px;
            box-shadow: inset 0 -3px 6px rgba(0,0,0,0.1);
        }

        .mouth.laugh::after {
            content: '';
            position: absolute;
            left: 15px;
            right: 15px;
            top: 20px;
            bottom: 10px;
            background: radial-gradient(circle at 50% 80%, #1b1b1b 0%, #111 60%, #0a0a0a 100%);
            border-radius: 0 0 115px 115px;
        }

        /* è¡¨æƒ…é©±åŠ¨çš„çœ¼ç‘/ç³å­”/çœ‰æ¯›å˜åŒ– */
        .face[data-expression="happy"] .lid.upper { transform: translateY(-2%); }
        .face[data-expression="happy"] .lid.lower { transform: translateY(8%); }
        .face[data-expression="happy"] .pupil { --pupil-scale: 1.0; }
        .face[data-expression="happy"] .eyebrow.left { transform: rotate(-8deg) translateY(-3px); }
        .face[data-expression="happy"] .eyebrow.right { transform: rotate(8deg) translateY(-3px); }

        .face[data-expression="surprised"] .lid.upper { transform: translateY(-28%); }
        .face[data-expression="surprised"] .lid.lower { transform: translateY(28%); }
        .face[data-expression="surprised"] .pupil { --pupil-scale: 0.85; }
        .face[data-expression="surprised"] .eyebrow.left,
        .face[data-expression="surprised"] .eyebrow.right { transform: translateY(-12px) rotate(0deg); }

        .face[data-expression="sad"] .lid.upper { transform: translateY(12%); }
        .face[data-expression="sad"] .lid.lower { transform: translateY(2%); }
        .face[data-expression="sad"] .pupil { --pupil-scale: 1.15; }
        .face[data-expression="sad"] .eyebrow.left { transform: rotate(15deg) translateY(6px); }
        .face[data-expression="sad"] .eyebrow.right { transform: rotate(-15deg) translateY(6px); }

        .face[data-expression="laugh"] .lid.upper { transform: translateY(18%); }
        .face[data-expression="laugh"] .lid.lower { transform: translateY(-4%); }
        .face[data-expression="laugh"] .pupil { --pupil-scale: 1.05; }

        /* åŠ¨ç”»å…³é”®å¸§ */
        @keyframes subtle-pop {
            from { transform: scale(0.96); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes eye-sparkle {
            0%, 100% {
                opacity: 0.9;
                transform: scale(1);
            }
            50% {
                opacity: 0.6;
                transform: scale(0.8);
            }
        }

        @keyframes blink {
            0%, 85%, 100% {
                transform: scaleY(1);
            }
            90% {
                transform: scaleY(0.3);
            }
            95% {
                transform: scaleY(0.05);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }
        
        @keyframes glow-pulse {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
                filter: brightness(1);
            }
            50% { 
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
                filter: brightness(1.1);
            }
        }
        
        @keyframes color-shift {
            0% { filter: hue-rotate(0deg); }
            25% { filter: hue-rotate(90deg); }
            50% { filter: hue-rotate(180deg); }
            75% { filter: hue-rotate(270deg); }
            100% { filter: hue-rotate(360deg); }
        }

        /* çœ¨çœ¼åŠ¨ç”» */
        .eye.blinking .eyelid {
            animation: blink 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @keyframes mouthPulse {
            0%, 100% { 
                transform: translateX(-50%) scale(1.05); 
                filter: brightness(1);
            }
            50% { 
                transform: translateX(-50%) scale(1.08); 
                filter: brightness(1.03);
            }
        }

        @keyframes mouthShake {
            0%, 100% { transform: translateX(-50%) rotate(0deg); }
            25% { transform: translateX(-50%) rotate(-2deg); }
            75% { transform: translateX(-50%) rotate(2deg); }
        }

        @keyframes mouthBounce {
            0%, 100% { 
                transform: translateX(-50%) translateY(0) scale(1); 
                filter: brightness(1);
            }
            50% { 
                transform: translateX(-50%) translateY(-3px) scale(1.02); 
                filter: brightness(1.02);
            }
        }

        /* UI æ§ä»¶æ ·å¼ */
        .controls {
            position: fixed;
            top: 20px;
            right: 30px;
            z-index: 30;
            background: rgba(255,255,255,0.12);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 16px;
            padding: 12px;
            display: flex;
            gap: 10px;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        .control-group {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .theme-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            margin: 0 8px;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 3px solid rgba(255, 255, 255, 0.4);
            position: relative;
            transform: scale(1);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.2),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .theme-dot::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: rotate(-45deg);
            transition: transform 0.6s ease;
            opacity: 0;
        }

        .theme-dot:hover {
            transform: scale(1.25) rotate(3deg);
            border-color: rgba(255, 255, 255, 0.8);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.2),
                inset 0 2px 6px rgba(255, 255, 255, 0.4);
        }

        .theme-dot:hover::before {
            opacity: 1;
            transform: rotate(-45deg) translateX(100%);
        }

        .theme-dot:active {
            transform: scale(1.05) rotate(-1deg);
            transition: transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .theme-dot[data-theme="blue"] {
            background: linear-gradient(135deg, #6ec3ff, #328bd7);
        }

        .theme-dot[data-theme="green"] {
            background: linear-gradient(135deg, #9be7a3, #38b06b);
        }

        .theme-dot[data-theme="brown"] {
            background: linear-gradient(135deg, #e0b38a, #a06a3e);
        }

        .theme-dot[data-theme="gray"] {
            background: linear-gradient(135deg, #cfe3ef, #7fa0b6);
        }

        .theme-dot.active {
            border-color: #FFD700;
            box-shadow: 
                0 6px 18px rgba(255, 215, 0, 0.4),
                0 0 15px rgba(255, 215, 0, 0.3),
                inset 0 2px 6px rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
            animation: active-glow 2s ease-in-out infinite;
        }

        .theme-dot.active:hover {
            transform: scale(1.4) rotate(10deg);
            box-shadow: 
                0 10px 30px rgba(255, 215, 0, 0.5),
                0 0 25px rgba(255, 215, 0, 0.4),
                inset 0 3px 8px rgba(255, 255, 255, 0.6);
        }

        @keyframes active-glow {
            0%, 100% { 
                box-shadow: 
                    0 6px 18px rgba(255, 215, 0, 0.4),
                    0 0 15px rgba(255, 215, 0, 0.3),
                    inset 0 2px 6px rgba(255, 255, 255, 0.5);
            }
            50% { 
                box-shadow: 
                    0 8px 24px rgba(255, 215, 0, 0.6),
                    0 0 25px rgba(255, 215, 0, 0.5),
                    inset 0 3px 8px rgba(255, 255, 255, 0.7);
            }
        }

        .theme-dot:focus-visible {
            outline: 2px solid rgba(255,255,255,0.95);
            outline-offset: 2px;
            box-shadow: 0 0 0 3px rgba(0,0,0,0.25);
        }

        /* æç¤ºæ–‡æ¡ˆ */
        .hint-text {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.8;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .hint-text p {
            margin: 8px 0;
            transition: color 0.3s ease;
        }

        .hint-text:hover p {
            color: rgba(255, 255, 255, 1);
        }

        /* è£…é¥°æ€§æµ®åŠ¨ç²’å­ */
        .decorative-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .floating-particle {
            position: absolute;
            font-size: 20px;
            opacity: 0.6;
            animation: float 8s ease-in-out infinite;
            animation-delay: var(--delay);
            left: var(--x);
            top: var(--y);
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0.6;
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
                opacity: 0.8;
            }
        }

        @keyframes fadeOut {
            0% { opacity: 0; transform: translateY(6px); }
            10% { opacity: 0.92; transform: translateY(0); }
            80% { opacity: 0.8; }
            100% { opacity: 0; }
        }

        /* æ— éšœç¢ä¸åŠ¨æ•ˆåå¥½ */
        @media (prefers-reduced-motion: reduce) {
            * { animation: none !important; transition: none !important; }
            .face { animation: none; }
        }

        /* è¡¨æƒ…é©±åŠ¨çš„çœ¼ç‘å˜åŒ– */
        .emotion-happy .eyelid {
            transform: translateY(-2px);
        }

        .emotion-sad .eyelid {
            transform: translateY(2px);
        }

        .emotion-surprised .eyelid {
            transform: translateY(-8px);
        }

        .emotion-angry .eyelid {
            transform: translateY(1px) scaleY(0.7);
        }

        /* è¡¨æƒ…é©±åŠ¨çš„ç³å­”å˜åŒ– */
        .emotion-happy .iris {
            transform: translate(-50%, -50%) scale(1.1);
        }

        .emotion-sad .iris {
            transform: translate(-50%, -50%) scale(0.9);
        }

        .emotion-surprised .iris {
            transform: translate(-50%, -50%) scale(1.3);
        }

        .emotion-angry .iris {
            transform: translate(-50%, -50%) scale(0.8);
        }

        /* äº¤äº’åé¦ˆæ•ˆæœ */
        .face {
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .face:hover {
            transform: scale(1.05);
            filter: brightness(1.1) saturate(1.2);
            box-shadow: 
                0 0 30px rgba(255, 215, 0, 0.4),
                0 0 60px rgba(255, 215, 0, 0.2),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
        }
        
        .face:active {
            transform: scale(0.95);
            filter: brightness(0.9) saturate(0.8);
            box-shadow: 
                0 0 15px rgba(255, 215, 0, 0.3),
                inset 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* çœ¼ç›äº¤äº’åé¦ˆ */
        .eye:hover {
            transform: scale(1.1);
            transition: transform 0.2s ease;
        }
        
        .eye:hover .iris {
            box-shadow: 
                0 0 15px rgba(139, 69, 19, 0.6),
                inset 2px 2px 4px rgba(160, 82, 45, 0.8),
                inset -2px -2px 4px rgba(101, 67, 33, 0.8);
        }
        
        /* å˜´å·´äº¤äº’åé¦ˆ */
        .mouth:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
            transition: all 0.2s ease;
        }

        /* åŠ¨æ€èƒŒæ™¯è‰²å½©ç³»ç»Ÿ */
        body.emotion-happy {
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 193, 7, 0.2), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 235, 59, 0.15), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 152, 0, 0.1), transparent 50%),
                linear-gradient(135deg, #ffeb3b 0%, #ffc107 25%, #ff9800 50%, #ff5722 75%, #e91e63 100%);
        }

        body.emotion-sad {
            background: 
                radial-gradient(circle at 20% 80%, rgba(63, 81, 181, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(103, 58, 183, 0.2), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(33, 150, 243, 0.15), transparent 50%),
                linear-gradient(135deg, #3f51b5 0%, #303f9f 25%, #1a237e 50%, #283593 75%, #3949ab 100%);
        }

        body.emotion-surprised {
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 188, 212, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 150, 136, 0.2), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(76, 175, 80, 0.15), transparent 50%),
                linear-gradient(135deg, #00bcd4 0%, #009688 25%, #4caf50 50%, #8bc34a 75%, #cddc39 100%);
        }

        body.emotion-angry {
            background: 
                radial-gradient(circle at 20% 80%, rgba(244, 67, 54, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(233, 30, 99, 0.2), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(156, 39, 176, 0.15), transparent 50%),
                linear-gradient(135deg, #f44336 0%, #e91e63 25%, #9c27b0 50%, #673ab7 75%, #3f51b5 100%);
        }
        
        /* èƒŒæ™¯æ¨¡å¼åˆ‡æ¢ */
        body.bg-mode-night {
            background: 
                radial-gradient(circle at 20% 30%, rgba(25, 25, 112, 0.4) 0%, transparent 60%),
                radial-gradient(circle at 80% 70%, rgba(72, 61, 139, 0.3) 0%, transparent 60%),
                linear-gradient(135deg, #0F0F23 0%, #1A1A2E 50%, #16213E 100%);
        }
        
        body.bg-mode-rainbow {
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 0, 150, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(0, 255, 150, 0.3) 0%, transparent 50%),
                linear-gradient(45deg, #FF6B6B 0%, #4ECDC4 25%, #45B7D1 50%, #96CEB4 75%, #FFEAA7 100%);
            animation: rainbow-shift 10s ease-in-out infinite;
        }
        
        body.bg-mode-minimal {
            background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%);
        }
        
        @keyframes rainbow-shift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }
        
        /* å¤œé—´æ¨¡å¼ä¸‹çš„è¡¨æƒ…è°ƒæ•´ */
        body.bg-mode-night .face {
            background: radial-gradient(circle at 30% 30%, #FFE135 0%, #FFC107 70%, #FF8F00 100%);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 10px 20px rgba(255, 193, 7, 0.3),
                inset 0 2px 4px rgba(255, 255, 255, 0.4);
        }
        
        /* å½©è™¹æ¨¡å¼ä¸‹çš„è¡¨æƒ…è°ƒæ•´ */
        body.bg-mode-rainbow .face {
            animation: face-rainbow 5s ease-in-out infinite;
        }
        
        @keyframes face-rainbow {
            0%, 100% { filter: hue-rotate(0deg) saturate(1); }
            25% { filter: hue-rotate(90deg) saturate(1.2); }
            50% { filter: hue-rotate(180deg) saturate(1.4); }
            75% { filter: hue-rotate(270deg) saturate(1.2); }
        }
        
        /* ç®€çº¦æ¨¡å¼ä¸‹çš„è¡¨æƒ…è°ƒæ•´ */
        body.bg-mode-minimal .face {
            background: linear-gradient(135deg, #FFF3C4 0%, #FFE082 100%);
            box-shadow: 
                0 10px 20px rgba(0, 0, 0, 0.1),
                0 5px 10px rgba(255, 193, 7, 0.2);
        }
        
        body.bg-mode-minimal .mouth {
            border-color: #666;
        }
        
        body.bg-mode-minimal .eyebrow {
            background: #666;
        }
        
        /* æç¤ºæ–‡æ¡ˆæ ·å¼ - é‡æ–°è®¾è®¡ä¸ºå·¦ä¾§å¸ƒå±€ */
        .hint-text {
            position: fixed;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            text-align: left;
            color: rgba(255, 255, 255, 0.85);
            font-size: 13px;
            line-height: 1.8;
            max-width: 280px;
            padding: 25px 20px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 10;
        }
        
        .hint-text:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-50%) translateX(5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.18);
            border-color: rgba(255, 255, 255, 0.25);
        }
        
        .hint-text p {
            margin: 6px 0;
            opacity: 0.88;
            transition: all 0.3s ease;
            font-weight: 400;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .hint-text p:hover {
            opacity: 1;
            color: #fff;
            transform: translateX(3px);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* è£…é¥°æ€§å…ƒç´ æ ·å¼ */
        .decorative-elements {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .floating-particle {
            position: absolute;
            font-size: 20px;
            opacity: 0.6;
            animation: float-around 8s infinite ease-in-out;
            animation-delay: var(--delay, 0s);
            left: var(--x, 50%);
            top: var(--y, 50%);
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
        }
        
        @keyframes float-around {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 0.6;
            }
            25% {
                transform: translate(20px, -30px) rotate(90deg) scale(1.2);
                opacity: 0.8;
            }
            50% {
                transform: translate(-15px, -20px) rotate(180deg) scale(0.8);
                opacity: 1;
            }
            75% {
                transform: translate(-25px, 15px) rotate(270deg) scale(1.1);
                opacity: 0.7;
            }
        }
        
        /* èƒŒæ™¯æ¨¡å¼ä¸‹çš„è£…é¥°å…ƒç´ è°ƒæ•´ */
        .bg-mode-night .floating-particle {
            filter: drop-shadow(0 0 15px rgba(100, 200, 255, 0.8));
        }
        
        .bg-mode-rainbow .floating-particle {
            animation: float-around 8s infinite ease-in-out, rainbow-glow 3s infinite;
        }
        
        @keyframes rainbow-glow {
            0% { filter: drop-shadow(0 0 10px #ff6b6b); }
            16% { filter: drop-shadow(0 0 10px #ffa500); }
            33% { filter: drop-shadow(0 0 10px #ffff00); }
            50% { filter: drop-shadow(0 0 10px #00ff00); }
            66% { filter: drop-shadow(0 0 10px #00bfff); }
            83% { filter: drop-shadow(0 0 10px #8a2be2); }
            100% { filter: drop-shadow(0 0 10px #ff6b6b); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .hint-text {
                left: 20px;
                max-width: 250px;
                font-size: 12px;
                padding: 20px 15px;
            }
        }
        
        @media (max-width: 768px) {
            .emoji-container {
                width: 250px;
                height: 250px;
            }
            
            .eyes {
                gap: 40px;
            }
            
            .eye {
                width: 50px;
                height: 50px;
            }
            
            .iris {
                width: 30px;
                height: 30px;
            }
            
            .pupil {
                width: 12px;
                height: 12px;
            }
            
            .hint-text {
                position: fixed;
                bottom: 20px;
                left: 50%;
                top: auto;
                transform: translateX(-50%);
                text-align: center;
                max-width: 90%;
                font-size: 11px;
                padding: 15px;
            }
            
            .controls {
                top: 15px;
                right: 15px;
                transform: scale(0.9);
            }
        }

        @media (max-width: 480px) {
            .emoji-container {
                width: 200px;
                height: 200px;
            }
            
            .eyes {
                gap: 35px;
            }
            
            .eye {
                width: 40px;
                height: 40px;
            }
            
            .iris {
                width: 24px;
                height: 24px;
            }
            
            .pupil {
                width: 10px;
                height: 10px;
            }
            
            .controls {
                transform: scale(0.8);
                top: 10px;
                right: 10px;
            }
            
            .hint-text {
                bottom: 15px;
                font-size: 10px;
                padding: 12px;
                max-width: 95%;
            }
            
            .floating-particle {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="emoji-container">
        <div class="face" data-expression="neutral">
            <!-- çœ‰æ¯› -->
            <div class="eyebrow left"></div>
            <div class="eyebrow right"></div>
            
            <!-- çœ¼ç› -->
            <div class="eyes">
                <div class="eye left">
                    <div class="lid upper"></div>
                    <div class="lid lower"></div>
                    <div class="iris">
                        <div class="pupil"></div>
                    </div>
                </div>
                <div class="eye right">
                    <div class="lid upper"></div>
                    <div class="lid lower"></div>
                    <div class="iris">
                        <div class="pupil"></div>
                    </div>
                </div>
            </div>
            
            <!-- å˜´å·´ -->
            <div class="mouth neutral"></div>
        </div>
        
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="controls">
            <div class="control-group">
                <div class="theme-dot" data-function="background" aria-label="èƒŒæ™¯æ¨¡å¼åˆ‡æ¢" title="èƒŒæ™¯æ¨¡å¼åˆ‡æ¢" tabindex="0">ğŸŒ™</div>
                <div class="theme-dot" data-function="iris" aria-label="è™¹è†œä¸»é¢˜å¾ªç¯" title="è™¹è†œä¸»é¢˜å¾ªç¯" tabindex="0">ğŸ‘ï¸</div>
                <div class="theme-dot" data-function="animation" aria-label="åŠ¨ç”»æ¨¡å¼åˆ‡æ¢" title="åŠ¨ç”»æ¨¡å¼åˆ‡æ¢" tabindex="0">âš¡</div>
                <div class="theme-dot" data-function="random" aria-label="éšæœºè¡¨æƒ…" title="éšæœºè¡¨æƒ…" tabindex="0">ğŸ²</div>
            </div>
        </div>
        
        <!-- æç¤ºæ–‡æ¡ˆ -->
        <div class="hint-text">
            <p>ğŸ‘€ çœ¼ç›ä¼šè·Ÿéšä½ çš„é¼ æ ‡ç§»åŠ¨</p>
            <p>ğŸ˜Š å˜´å·´ä¼šæ ¹æ®é¼ æ ‡è·ç¦»å˜åŒ–è¡¨æƒ…</p>
            <p>ğŸŒ™ ç‚¹å‡»æœˆäº®åˆ‡æ¢èƒŒæ™¯æ¨¡å¼</p>
            <p>ğŸ‘ï¸ ç‚¹å‡»çœ¼ç›å¾ªç¯è™¹è†œä¸»é¢˜</p>
            <p>âš¡ ç‚¹å‡»é—ªç”µåˆ‡æ¢åŠ¨ç”»æ¨¡å¼</p>
            <p>ğŸ² ç‚¹å‡»éª°å­éšæœºè¡¨æƒ…</p>
            <p>âŒ¨ï¸ æŒ‰é”®ç›˜ 1-5 å¿«é€Ÿåˆ‡æ¢è¡¨æƒ…</p>
            <p>âœ¨ æ‚¬åœåœ¨è¡¨æƒ…ä¸ŠæŸ¥çœ‹äº¤äº’æ•ˆæœ</p>
        </div>

        <!-- è£…é¥°æ€§å…ƒç´  -->
        <div class="decorative-elements">
            <div class="floating-particle" style="--delay: 0s; --x: 10%; --y: 20%;">âœ¨</div>
            <div class="floating-particle" style="--delay: 2s; --x: 85%; --y: 15%;">ğŸ’«</div>
            <div class="floating-particle" style="--delay: 4s; --x: 15%; --y: 80%;">â­</div>
            <div class="floating-particle" style="--delay: 6s; --x: 90%; --y: 75%;">âœ¨</div>
            <div class="floating-particle" style="--delay: 1s; --x: 50%; --y: 10%;">ğŸŒŸ</div>
            <div class="floating-particle" style="--delay: 3s; --x: 5%; --y: 50%;">ğŸ’«</div>
        </div>
    </div>

    <script>
        // è¡¨æƒ…çŠ¶æ€ç®¡ç†ç³»ç»Ÿ
        class EmotionManager {
            constructor() {
                this.currentExpression = 'neutral';
                this.currentMouthState = 'neutral';
                this.isAnimating = false;
                this.mousePosition = { x: 0, y: 0 };
                this.faceElement = document.querySelector('.face');
                this.mouthElement = document.querySelector('.mouth');
                this.irisElements = document.querySelectorAll('.iris');
                this.expressions = ['neutral', 'happy', 'surprised', 'sad', 'laugh'];
                this.mouthStates = ['neutral', 'happy', 'surprised', 'sad', 'laugh'];
                
                // åŠ¨ç”»åŒæ­¥æœºåˆ¶
                this.animationQueue = [];
                this.isAnimationRunning = false;
                this.animationStartTime = 0;
                this.lastAnimationFrame = 0;
                
                // æ–°å¢çŠ¶æ€ç®¡ç†
                this.currentIrisTheme = 'blue';
                this.currentBackgroundMode = 'default';
                this.animationMode = 'normal';
                this.animationEnabled = true; // åŠ¨ç”»å¯ç”¨çŠ¶æ€
                this.blinkInterval = null; // çœ¨çœ¼å®šæ—¶å™¨
                this.backgroundModes = ['default', 'night', 'rainbow', 'minimal'];
                this.irisThemes = ['blue', 'green', 'brown', 'gray', 'purple', 'amber'];
                
                this.init();
            }
            
            init() {
                this.setupMouseTracking();
                this.setupMouthTriggers();
                this.setupThemeControls();
                this.setupKeyboardControls();
                this.setupBlinking();
                this.loadSavedTheme();
                this.startAnimationLoop();
                
                // è®¾ç½®é»˜è®¤ä¸»é¢˜
                document.body.setAttribute('data-iris-theme', this.currentIrisTheme);
                if (this.currentBackgroundMode !== 'default') {
                    document.body.classList.add(`bg-mode-${this.currentBackgroundMode}`);
                }
            }
            
            // åŠ¨ç”»åŒæ­¥ç³»ç»Ÿ
            startAnimationLoop() {
                const animate = (timestamp) => {
                    if (!this.lastAnimationFrame) {
                        this.lastAnimationFrame = timestamp;
                    }
                    
                    const deltaTime = timestamp - this.lastAnimationFrame;
                    this.processAnimationQueue(deltaTime);
                    this.lastAnimationFrame = timestamp;
                    
                    requestAnimationFrame(animate);
                };
                requestAnimationFrame(animate);
            }
            
            processAnimationQueue(deltaTime) {
                if (this.animationQueue.length === 0) {
                    this.isAnimationRunning = false;
                    return;
                }
                
                this.isAnimationRunning = true;
                const currentAnimation = this.animationQueue[0];
                
                if (!currentAnimation.startTime) {
                    currentAnimation.startTime = performance.now();
                }
                
                const elapsed = performance.now() - currentAnimation.startTime;
                const progress = Math.min(elapsed / currentAnimation.duration, 1);
                
                // æ‰§è¡ŒåŠ¨ç”»
                currentAnimation.update(progress);
                
                // åŠ¨ç”»å®Œæˆï¼Œç§»é™¤é˜Ÿåˆ—
                if (progress >= 1) {
                    if (currentAnimation.onComplete) {
                        currentAnimation.onComplete();
                    }
                    this.animationQueue.shift();
                }
            }
            
            addToAnimationQueue(animation) {
                this.animationQueue.push(animation);
            }
            
            // ç»Ÿä¸€çš„åŠ¨ç”»è§¦å‘æ–¹æ³•
            triggerSynchronizedAnimation(type, params = {}) {
                const animation = {
                    type: type,
                    duration: params.duration || 350,
                    startTime: null,
                    update: (progress) => {
                        const easeProgress = this.easeInOutCubic(progress);
                        
                        switch (type) {
                            case 'expression_change':
                                this.updateExpressionAnimation(easeProgress, params);
                                break;
                            case 'eye_movement':
                                this.updateEyeMovementAnimation(easeProgress, params);
                                break;
                            case 'eyebrow_sync':
                                this.updateEyebrowSyncAnimation(easeProgress, params);
                                break;
                        }
                    },
                    onComplete: params.onComplete
                };
                
                this.addToAnimationQueue(animation);
            }
            
            easeInOutCubic(t) {
                return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
            }
            
            updateExpressionAnimation(progress, params) {
                // åŒæ­¥çœ¼ç›ã€çœ‰æ¯›ã€å˜´å·´çš„è¡¨æƒ…å˜åŒ–
                const intensity = progress * params.intensity || progress;
                
                if (params.eyeChanges) {
                    this.applyEyeChanges(params.eyeChanges, intensity);
                }
                if (params.eyebrowChanges) {
                    this.applyEyebrowChanges(params.eyebrowChanges, intensity);
                }
                if (params.mouthChanges) {
                    this.applyMouthChanges(params.mouthChanges, intensity);
                }
            }
            
            updateEyeMovementAnimation(progress, params) {
                // çœ¼ç›ç§»åŠ¨æ—¶çš„åè°ƒåŠ¨ç”»
                const smoothProgress = this.easeInOutCubic(progress);
                
                if (params.eyePosition) {
                    this.updateEyePosition(params.eyePosition, smoothProgress);
                }
                if (params.eyebrowFollow) {
                    this.updateEyebrowFollow(params.eyebrowFollow, smoothProgress);
                }
            }
            
            updateEyebrowSyncAnimation(progress, params) {
                // çœ‰æ¯›åŒæ­¥åŠ¨ç”»
                const eyebrows = document.querySelectorAll('.eyebrow');
                eyebrows.forEach((eyebrow, index) => {
                    if (params.transforms && params.transforms[index]) {
                        const transform = params.transforms[index];
                        const currentTransform = this.interpolateTransform(transform.from, transform.to, progress);
                        eyebrow.style.transform = currentTransform;
                    }
                });
            }
            
            interpolateTransform(from, to, progress) {
                // æ’å€¼è®¡ç®—å˜æ¢
                const fromValues = this.parseTransform(from);
                const toValues = this.parseTransform(to);
                const result = {};
                
                for (let key in fromValues) {
                    if (toValues[key] !== undefined) {
                        result[key] = fromValues[key] + (toValues[key] - fromValues[key]) * progress;
                    }
                }
                
                return this.buildTransformString(result);
            }
            
            parseTransform(transformString) {
                // è§£ætransformå­—ç¬¦ä¸²
                const result = { translateY: 0, rotate: 0, scaleY: 1 };
                const matches = transformString.match(/(\w+)\(([^)]+)\)/g);
                
                if (matches) {
                    matches.forEach(match => {
                        const [, func, value] = match.match(/(\w+)\(([^)]+)\)/);
                        result[func] = parseFloat(value);
                    });
                }
                
                return result;
            }
            
            buildTransformString(values) {
                // æ„å»ºtransformå­—ç¬¦ä¸²
                let transform = '';
                if (values.translateY !== undefined) transform += `translateY(${values.translateY}px) `;
                if (values.rotate !== undefined) transform += `rotate(${values.rotate}deg) `;
                if (values.scaleY !== undefined) transform += `scaleY(${values.scaleY}) `;
                return transform.trim();
            }
            
            setupBlinking() {
                const eyes = document.querySelectorAll('.eye');
                
                const blink = () => {
                    if (!this.animationEnabled) return; // æ£€æŸ¥åŠ¨ç”»æ˜¯å¦å¯ç”¨
                    
                    eyes.forEach(eye => {
                        eye.classList.add('blinking');
                        setTimeout(() => {
                            eye.classList.remove('blinking');
                        }, 300);
                    });
                };
                
                // éšæœºçœ¨çœ¼é—´éš” 2-6ç§’
                const scheduleNextBlink = () => {
                    if (!this.animationEnabled) {
                        // å¦‚æœåŠ¨ç”»è¢«ç¦ç”¨ï¼Œå»¶è¿Ÿæ£€æŸ¥
                        this.blinkInterval = setTimeout(scheduleNextBlink, 1000);
                        return;
                    }
                    
                    const interval = Math.random() * 4000 + 2000;
                    this.blinkInterval = setTimeout(() => {
                        blink();
                        scheduleNextBlink();
                    }, interval);
                };
                
                scheduleNextBlink();
            }
            
            // åœæ­¢çœ¨çœ¼åŠ¨ç”»
            stopBlinking() {
                if (this.blinkInterval) {
                    clearTimeout(this.blinkInterval);
                    this.blinkInterval = null;
                }
            }
            
            // é‡æ–°å¯åŠ¨çœ¨çœ¼åŠ¨ç”»
            restartBlinking() {
                this.stopBlinking();
                this.setupBlinking();
            }
            
            // é¼ æ ‡è¿½è¸ªçœ¼ç›åŠŸèƒ½
            setupMouseTracking() {
                let isMouseMoving = false;
                let mouseTimeout;
                let clickCount = 0;
                
                document.addEventListener('mousemove', (e) => {
                    isMouseMoving = true;
                    clearTimeout(mouseTimeout);
                    
                    this.mousePosition.x = e.clientX;
                    this.mousePosition.y = e.clientY;
                    this.updateEyeTracking();
                    
                    mouseTimeout = setTimeout(() => {
                        isMouseMoving = false;
                    }, 100);
                });
                
                // æ·»åŠ ç‚¹å‡»äº¤äº’
                this.faceElement.addEventListener('click', (e) => {
                    clickCount++;
                    this.triggerClickResponse(clickCount);
                    
                    setTimeout(() => {
                        clickCount = Math.max(0, clickCount - 1);
                    }, 1000);
                });
                
                // æ·»åŠ é•¿æŒ‰äº¤äº’
                let pressTimer;
                this.faceElement.addEventListener('mousedown', () => {
                    pressTimer = setTimeout(() => {
                        this.triggerLongPressResponse();
                    }, 800);
                });
                
                this.faceElement.addEventListener('mouseup', () => {
                    clearTimeout(pressTimer);
                });
                
                // æ·»åŠ æ‚¬åœæ•ˆæœ
                let hoverTimer;
                this.faceElement.addEventListener('mouseenter', () => {
                    hoverTimer = setTimeout(() => {
                        this.triggerHoverEffect();
                    }, 2000); // æ‚¬åœ2ç§’åè§¦å‘ç‰¹æ•ˆ
                });
                
                this.faceElement.addEventListener('mouseleave', () => {
                    clearTimeout(hoverTimer);
                    this.clearHoverEffect();
                });
            }
            
            triggerHoverEffect() {
                // é•¿æ—¶é—´æ‚¬åœå‘å…‰æ•ˆæœ
                this.faceElement.style.animation = 'glow-pulse 3s infinite';
            }
            
            clearHoverEffect() {
                // æ¸…é™¤æ‚¬åœæ•ˆæœ
                if (this.faceElement.style.animation.includes('glow-pulse')) {
                    this.faceElement.style.animation = 'none';
                }
            }
            
            triggerClickResponse(clickCount) {
                const expressions = ['happy', 'surprised', 'neutral', 'sad'];
                const expression = expressions[clickCount % expressions.length];
                this.setExpression(expression);
                
                // æ·»åŠ ç‚¹å‡»åŠ¨ç”»å’Œç‰¹æ•ˆ
                this.faceElement.style.animation = 'none';
                setTimeout(() => {
                    if (clickCount >= 3) {
                        // è¿ç»­ç‚¹å‡»è§¦å‘å½©è™¹æ•ˆæœ
                        this.faceElement.style.animation = 'color-shift 2s ease, subtle-pop 0.3s ease';
                    } else {
                        this.faceElement.style.animation = 'subtle-pop 0.3s ease';
                    }
                }, 10);
                
                // åŒå‡»ç‰¹æ•ˆ
                if (clickCount === 2) {
                    this.triggerDoubleClickEffect();
                }
            }
            
            triggerDoubleClickEffect() {
                // åŒå‡»å‘å…‰æ•ˆæœ
                this.faceElement.style.animation = 'glow-pulse 1s ease';
                
                // çœ¼ç›é—ªçƒæ•ˆæœ
                const eyes = document.querySelectorAll('.eye');
                eyes.forEach(eye => {
                    eye.style.animation = 'eye-sparkle 0.5s ease';
                });
                
                setTimeout(() => {
                    this.faceElement.style.animation = 'none';
                    eyes.forEach(eye => {
                        eye.style.animation = 'none';
                    });
                }, 1000);
            }
            
            triggerLongPressResponse() {
                // é•¿æŒ‰è§¦å‘ç‰¹æ®Šè¡¨æƒ…
                this.setExpression('angry');
                
                // æ·»åŠ éœ‡åŠ¨æ•ˆæœ
                this.faceElement.style.animation = 'shake 0.5s ease';
                setTimeout(() => {
                    this.faceElement.style.animation = 'none';
                }, 500);
            }
            
            updateEyeTracking() {
                const container = document.querySelector('.emoji-container');
                const containerRect = container.getBoundingClientRect();
                const centerX = containerRect.left + containerRect.width / 2;
                const centerY = containerRect.top + containerRect.height / 2;
                
                const deltaX = this.mousePosition.x - centerX;
                const deltaY = this.mousePosition.y - centerY;
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                
                // è°ƒæ•´çœ¼çƒç§»åŠ¨èŒƒå›´ï¼Œä½¿å…¶ä¸150%æ”¾å¤§åçš„é¢éƒ¨æ¯”ä¾‹åè°ƒ
                const maxMove = 14; // é€‚åº¦å‡å°‘ç§»åŠ¨èŒƒå›´ï¼Œä¿æŒåè°ƒæ€§
                const sensitivity = 0.035; // é™ä½æ•æ„Ÿåº¦ï¼Œé¿å…è¿‡åº¦å¤¸å¼ 
                const moveX = Math.max(-maxMove, Math.min(maxMove, deltaX * sensitivity));
                const moveY = Math.max(-maxMove, Math.min(maxMove, deltaY * sensitivity));
                
                // æ ¹æ®é¼ æ ‡è·ç¦»åŠ¨æ€è°ƒæ•´çœ¼ç›å¤§å°ï¼ˆé€‚åº¦è°ƒæ•´å˜åŒ–å¹…åº¦ï¼‰
                const maxDistance = 300;
                const normalizedDistance = Math.min(distance / maxDistance, 1);
                const eyeScale = 1 + (normalizedDistance * 0.2); // çœ¼ç›å¯æ”¾å¤§åˆ°1.2å€ï¼Œæ›´åè°ƒ
                const irisScale = 1 + (normalizedDistance * 0.25); // è™¹è†œå¯æ”¾å¤§åˆ°1.25å€ï¼Œä¿æŒè‡ªç„¶
                
                // æ ¹æ®ç§»åŠ¨æ–¹å‘è°ƒæ•´çœ¼ç›å½¢çŠ¶ï¼ˆå‡å°‘å˜å½¢å¹…åº¦ï¼‰
                const horizontalStretch = 1 + Math.abs(moveX) * 0.015; // é™ä½æ°´å¹³æ‹‰ä¼¸
                const verticalStretch = 1 + Math.abs(moveY) * 0.015; // é™ä½å‚ç›´æ‹‰ä¼¸
                
                // æ·»åŠ å¾®å¦™çš„å¼¹æ€§æ•ˆæœå’Œè‡ªç„¶ç¼“åŠ¨
                const currentTime = Date.now();
                if (!this.lastUpdateTime) this.lastUpdateTime = currentTime;
                const deltaTime = Math.max(currentTime - this.lastUpdateTime, 1);
                
                // è®¡ç®—é€Ÿåº¦å˜åŒ–äº§ç”Ÿçš„å¼¹æ€§æ•ˆæœ
                const velocityX = (moveX - (this.lastMoveX || 0)) / deltaTime * 1000;
                const velocityY = (moveY - (this.lastMoveY || 0)) / deltaTime * 1000;
                
                // æ·»åŠ å¾®å¦™çš„æŒ¯è¡æ•ˆæœï¼Œè®©çœ¼ç›è¿åŠ¨æ›´ç”ŸåŠ¨
                const oscillationX = Math.sin(currentTime * 0.003) * 0.3;
                const oscillationY = Math.cos(currentTime * 0.002) * 0.2;
                
                // æ ¹æ®é€Ÿåº¦æ·»åŠ å¼¹æ€§åç§»
                const elasticX = Math.sin(velocityX * 0.01) * 0.8;
                const elasticY = Math.sin(velocityY * 0.01) * 0.8;
                
                const finalMoveX = moveX + elasticX + oscillationX;
                const finalMoveY = moveY + elasticY + oscillationY;
                
                const eyes = document.querySelectorAll('.eye');
                eyes.forEach(eye => {
                    eye.style.transform = `scale(${eyeScale}) scaleX(${horizontalStretch}) scaleY(${verticalStretch})`;
                });
                
                this.irisElements.forEach(iris => {
                    iris.style.transform = `translate(calc(-50% + ${finalMoveX}px), calc(-50% + ${finalMoveY}px)) scale(${irisScale})`;
                });
                
                // å­˜å‚¨å½“å‰å€¼ç”¨äºä¸‹æ¬¡è®¡ç®—
                this.lastUpdateTime = currentTime;
                this.lastMoveX = moveX;
                this.lastMoveY = moveY;
                
                // æ ¹æ®é¼ æ ‡è·ç¦»è§¦å‘å˜´å·´çŠ¶æ€å˜åŒ–
                this.updateMouthBasedOnDistance(deltaX, deltaY);
                
                // è§¦å‘çœ‰æ¯›è·Ÿéšçœ¼ç›è¿åŠ¨
                this.updateEyebrowsBasedOnEyeMovement(finalMoveX, finalMoveY, normalizedDistance);
            }
            
            // çœ‰æ¯›è·Ÿéšçœ¼ç›è¿åŠ¨çš„å‡½æ•°
            updateEyebrowsBasedOnEyeMovement(moveX, moveY, distance) {
                const leftEyebrow = document.querySelector('.eyebrow.left');
                const rightEyebrow = document.querySelector('.eyebrow.right');
                
                // åŸºç¡€è§’åº¦
                const baseLeftAngle = -15;
                const baseRightAngle = 15;
                
                // æ ¹æ®çœ¼ç›ç§»åŠ¨è°ƒæ•´çœ‰æ¯›è§’åº¦å’Œä½ç½®
                const angleAdjustment = moveX * 0.8; // æ°´å¹³ç§»åŠ¨å½±å“è§’åº¦
                const verticalAdjustment = moveY * 0.5; // å‚ç›´ç§»åŠ¨å½±å“é«˜åº¦
                const distanceEffect = distance * 15; // è·ç¦»å½±å“çœ‰æ¯›ä¸Šä¸‹ç§»åŠ¨
                
                // å·¦çœ‰æ¯›å˜åŒ–
                const leftAngle = baseLeftAngle + angleAdjustment;
                const leftVerticalOffset = -verticalAdjustment - distanceEffect;
                leftEyebrow.style.transform = `rotate(${leftAngle}deg) translateY(${leftVerticalOffset}px)`;
                
                // å³çœ‰æ¯›å˜åŒ–
                const rightAngle = baseRightAngle + angleAdjustment;
                const rightVerticalOffset = -verticalAdjustment - distanceEffect;
                rightEyebrow.style.transform = `rotate(${rightAngle}deg) translateY(${rightVerticalOffset}px)`;
                
                // æ ¹æ®çœ¼ç›ç§»åŠ¨å¹…åº¦è°ƒæ•´çœ‰æ¯›ç²—ç»†
                const eyeMovementIntensity = Math.sqrt(moveX * moveX + moveY * moveY) / 18;
                const browThickness = 9 + (eyeMovementIntensity * 3); // åŸºç¡€9pxï¼Œæœ€å¤§12px
                leftEyebrow.style.height = `${browThickness}px`;
                rightEyebrow.style.height = `${browThickness}px`;
            }
            
            // åŸºäºé¼ æ ‡ä½ç½®å’Œæ—¶é—´é—´éš”çš„å˜´å·´çŠ¶æ€è§¦å‘æœºåˆ¶
            setupMouthTriggers() {
                // å®šæ—¶éšæœºå˜åŒ–å˜´å·´çŠ¶æ€
                setInterval(() => {
                    if (!this.isAnimating && Math.random() < 0.3) {
                        this.randomMouthExpression();
                    }
                }, 3000);
                
                // ç‚¹å‡»è¡¨æƒ…æ—¶æ”¹å˜å˜´å·´çŠ¶æ€
                this.faceElement.addEventListener('click', () => {
                    this.cycleMouthExpression();
                });
            }
            
            updateMouthBasedOnDistance(deltaX, deltaY) {
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                const maxDistance = Math.sqrt(window.innerWidth ** 2 + window.innerHeight ** 2);
                const normalizedDistance = Math.min(distance / maxDistance, 1);
                
                // å¢å¼ºçš„å˜´å·´å“åº”é€»è¾‘
                if (normalizedDistance < 0.1) {
                    this.setMouthState('happy');
                    this.setMouthIntensity('high');
                } else if (normalizedDistance < 0.25) {
                    this.setMouthState('happy');
                    this.setMouthIntensity('medium');
                } else if (normalizedDistance < 0.4) {
                    this.setMouthState('neutral');
                    this.setMouthIntensity('low');
                } else if (normalizedDistance < 0.7) {
                    this.setMouthState('surprised');
                    this.setMouthIntensity('medium');
                } else {
                    this.setMouthState('sad');
                    this.setMouthIntensity('high');
                }
            }
            
            setMouthIntensity(intensity) {
                const mouth = document.querySelector('.mouth');
                mouth.classList.remove('intensity-low', 'intensity-medium', 'intensity-high');
                mouth.classList.add(`intensity-${intensity}`);
            }
            
            // è®¾ç½®è¡¨æƒ…çŠ¶æ€
            setExpression(expression) {
                if (this.isAnimationRunning || !this.expressions.includes(expression)) return;
                
                this.currentExpression = expression;
                
                // ä½¿ç”¨åŒæ­¥åŠ¨ç”»ç³»ç»Ÿ
                this.triggerSynchronizedAnimation('expression_change', {
                    duration: 350,
                    intensity: 1,
                    eyeChanges: this.getExpressionEyeChanges(expression),
                    eyebrowChanges: this.getExpressionEyebrowChanges(expression),
                    mouthChanges: this.getExpressionMouthChanges(expression),
                    onComplete: () => {
                        // ç§»é™¤æ‰€æœ‰è¡¨æƒ…ç±»
                        document.body.classList.remove('emotion-happy', 'emotion-sad', 'emotion-surprised', 'emotion-angry');
                        
                        // æ›´æ–°é¢éƒ¨è¡¨æƒ…
                        this.faceElement.setAttribute('data-expression', expression);
                        
                        // æ·»åŠ æ–°çš„è¡¨æƒ…ç±»åˆ°body
                        if (expression && expression !== 'neutral') {
                            document.body.classList.add(`emotion-${expression}`);
                        }
                        
                        // åŒæ­¥æ›´æ–°å˜´å·´çŠ¶æ€
                        this.setMouthState(expression);
                    }
                });
            }
            
            getExpressionEyeChanges(expression) {
                // æ ¹æ®è¡¨æƒ…è¿”å›çœ¼ç›å˜åŒ–å‚æ•°
                const changes = {
                    scale: 1,
                    shape: 'normal'
                };
                
                switch(expression) {
                    case 'happy':
                    case 'laugh':
                        changes.scale = 0.9;
                        changes.shape = 'squint';
                        break;
                    case 'surprised':
                        changes.scale = 1.3;
                        changes.shape = 'wide';
                        break;
                    case 'sad':
                        changes.scale = 0.95;
                        changes.shape = 'droopy';
                        break;
                }
                
                return changes;
            }
            
            getExpressionEyebrowChanges(expression) {
                // æ ¹æ®è¡¨æƒ…è¿”å›çœ‰æ¯›å˜åŒ–å‚æ•°
                const changes = {
                    angle: 0,
                    position: 0,
                    thickness: 9
                };
                
                switch(expression) {
                    case 'happy':
                    case 'laugh':
                        changes.angle = -8;
                        changes.position = -3;
                        changes.thickness = 8;
                        break;
                    case 'sad':
                        changes.angle = 12;
                        changes.position = 2;
                        changes.thickness = 10;
                        break;
                    case 'surprised':
                        changes.angle = 0;
                        changes.position = -8;
                        changes.thickness = 7;
                        break;
                    case 'angry':
                        changes.angle = 15;
                        changes.position = 5;
                        changes.thickness = 12;
                        break;
                }
                
                return changes;
            }
            
            getExpressionMouthChanges(expression) {
                // æ ¹æ®è¡¨æƒ…è¿”å›å˜´å·´å˜åŒ–å‚æ•°
                return {
                    state: expression,
                    intensity: this.getMouthIntensityForExpression(expression)
                };
            }
            
            getMouthIntensityForExpression(expression) {
                switch(expression) {
                    case 'laugh':
                        return 'high';
                    case 'happy':
                    case 'surprised':
                        return 'medium';
                    default:
                        return 'low';
                }
            }
            
            // è®¾ç½®å˜´å·´çŠ¶æ€
            setMouthState(state) {
                if (!this.mouthStates.includes(state)) return;
                
                this.currentMouthState = state;
                
                // ä½¿ç”¨åŒæ­¥åŠ¨ç”»ç³»ç»Ÿè§¦å‘çœ‰æ¯›è·Ÿéš
                this.triggerSynchronizedAnimation('eyebrow_sync', {
                    duration: 180, // ä¸çœ‰æ¯›è¿‡æ¸¡æ—¶é—´ä¸€è‡´
                    transforms: this.getEyebrowTransformsForMouthState(state),
                    onComplete: () => {
                        this.mouthElement.className = `mouth ${state}`;
                    }
                });
            }
            
            getEyebrowTransformsForMouthState(mouthState) {
                const leftEyebrow = document.querySelector('.eyebrow.left');
                const rightEyebrow = document.querySelector('.eyebrow.right');
                
                if (!leftEyebrow || !rightEyebrow) return [];
                
                // è·å–å½“å‰å˜æ¢
                const currentLeftTransform = leftEyebrow.style.transform || 'rotate(-15deg) translateY(0px)';
                const currentRightTransform = rightEyebrow.style.transform || 'rotate(15deg) translateY(0px)';
                
                // åŸºç¡€è§’åº¦
                const baseLeftAngle = -15;
                const baseRightAngle = 15;
                
                // æ ¹æ®å˜´å·´çŠ¶æ€è®¡ç®—ç›®æ ‡å˜æ¢
                let angleAdjustment = 0;
                let verticalOffset = 0;
                let browThickness = 9;
                
                switch(mouthState) {
                    case 'happy':
                    case 'laugh':
                        angleAdjustment = -8;
                        verticalOffset = -3;
                        browThickness = 8;
                        break;
                    case 'sad':
                        angleAdjustment = 12;
                        verticalOffset = 2;
                        browThickness = 10;
                        break;
                    case 'surprised':
                        angleAdjustment = 0;
                        verticalOffset = -8;
                        browThickness = 7;
                        break;
                    case 'angry':
                        angleAdjustment = 15;
                        verticalOffset = 5;
                        browThickness = 12;
                        break;
                    case 'neutral':
                    default:
                        angleAdjustment = 0;
                        verticalOffset = 0;
                        browThickness = 9;
                        break;
                }
                
                const leftAngle = baseLeftAngle + angleAdjustment;
                const rightAngle = baseRightAngle - angleAdjustment;
                
                const targetLeftTransform = `rotate(${leftAngle}deg) translateY(${verticalOffset}px)`;
                const targetRightTransform = `rotate(${rightAngle}deg) translateY(${verticalOffset}px)`;
                
                // åŒæ—¶æ›´æ–°çœ‰æ¯›ç²—ç»†
                setTimeout(() => {
                    leftEyebrow.style.height = `${browThickness}px`;
                    rightEyebrow.style.height = `${browThickness}px`;
                }, 90); // åœ¨åŠ¨ç”»ä¸­é€”æ›´æ–°ç²—ç»†
                
                return [
                    {
                        from: currentLeftTransform,
                        to: targetLeftTransform
                    },
                    {
                        from: currentRightTransform,
                        to: targetRightTransform
                    }
                ];
            }
            
            // çœ‰æ¯›è·Ÿéšå˜´å·´è¡¨æƒ…å˜åŒ–çš„å‡½æ•°
            updateEyebrowsBasedOnMouthState(mouthState) {
                const leftEyebrow = document.querySelector('.eyebrow.left');
                const rightEyebrow = document.querySelector('.eyebrow.right');
                
                if (!leftEyebrow || !rightEyebrow) return;
                
                // åŸºç¡€è§’åº¦
                const baseLeftAngle = -15;
                const baseRightAngle = 15;
                
                // æ ¹æ®å˜´å·´çŠ¶æ€è°ƒæ•´çœ‰æ¯›
                let angleAdjustment = 0;
                let verticalOffset = 0;
                let browThickness = 9;
                
                switch(mouthState) {
                    case 'happy':
                    case 'laugh':
                        angleAdjustment = -8; // çœ‰æ¯›å‘ä¸‹å€¾æ–œï¼Œæ˜¾å¾—æ›´å¼€å¿ƒ
                        verticalOffset = -3;
                        browThickness = 8; // ç¨å¾®å˜ç»†
                        break;
                    case 'sad':
                        angleAdjustment = 12; // çœ‰æ¯›å‘ä¸Šå€¾æ–œï¼Œæ˜¾å¾—å¿§ä¼¤
                        verticalOffset = 2;
                        browThickness = 10; // ç¨å¾®å˜ç²—
                        break;
                    case 'surprised':
                        angleAdjustment = 0; // ä¿æŒæ°´å¹³
                        verticalOffset = -8; // çœ‰æ¯›ä¸Šæ‰¬
                        browThickness = 7; // å˜ç»†
                        break;
                    case 'angry':
                        angleAdjustment = 15; // çœ‰æ¯›å‘å†…å€¾æ–œ
                        verticalOffset = 5; // çœ‰æ¯›ä¸‹å‹
                        browThickness = 12; // å˜ç²—
                        break;
                    case 'neutral':
                    default:
                        angleAdjustment = 0;
                        verticalOffset = 0;
                        browThickness = 9;
                        break;
                }
                
                // åº”ç”¨å˜åŒ–
                const leftAngle = baseLeftAngle + angleAdjustment;
                const rightAngle = baseRightAngle - angleAdjustment; // å³çœ‰æ¯›ç›¸åæ–¹å‘
                
                leftEyebrow.style.transform = `rotate(${leftAngle}deg) translateY(${verticalOffset}px)`;
                rightEyebrow.style.transform = `rotate(${rightAngle}deg) translateY(${verticalOffset}px)`;
                leftEyebrow.style.height = `${browThickness}px`;
                rightEyebrow.style.height = `${browThickness}px`;
            }
            
            // éšæœºè¡¨æƒ…
            randomExpression() {
                const randomExp = this.expressions[Math.floor(Math.random() * this.expressions.length)];
                this.setExpression(randomExp);
            }
            
            // éšæœºå˜´å·´è¡¨æƒ…
            randomMouthExpression() {
                const randomMouth = this.mouthStates[Math.floor(Math.random() * this.mouthStates.length)];
                this.setMouthState(randomMouth);
            }
            
            // å¾ªç¯åˆ‡æ¢å˜´å·´è¡¨æƒ…
            cycleMouthExpression() {
                const currentIndex = this.mouthStates.indexOf(this.currentMouthState);
                const nextIndex = (currentIndex + 1) % this.mouthStates.length;
                this.setMouthState(this.mouthStates[nextIndex]);
            }
            
            // è™¹è†œä¸»é¢˜æ§åˆ¶
            applyIrisTheme(theme) {
                // æ›´æ–°å½“å‰ä¸»é¢˜
                this.currentIrisTheme = theme;
                
                // ä½¿ç”¨CSSå˜é‡æ–¹å¼è®¾ç½®ä¸»é¢˜
                document.body.setAttribute('data-iris-theme', theme);
                
                this.saveTheme(theme);
            }
            
            saveTheme(theme) {
                try {
                    localStorage.setItem('irisTheme', theme);
                } catch (e) {
                    console.warn('æ— æ³•ä¿å­˜ä¸»é¢˜è®¾ç½®:', e);
                }
            }
            
            loadSavedTheme() {
                let savedTheme = 'blue';
                try {
                    savedTheme = localStorage.getItem('irisTheme') || 'blue';
                } catch (e) {
                    console.warn('æ— æ³•åŠ è½½ä¸»é¢˜è®¾ç½®:', e);
                }
                
                // ç¡®ä¿ä¿å­˜çš„ä¸»é¢˜åœ¨å¯ç”¨ä¸»é¢˜åˆ—è¡¨ä¸­
                if (this.irisThemes.includes(savedTheme)) {
                    this.currentIrisTheme = savedTheme;
                }
                
                this.applyIrisTheme(this.currentIrisTheme);
            }
            
            // ä¸»é¢˜æ§åˆ¶è®¾ç½®
            setupThemeControls() {
                const themeDots = document.querySelectorAll('.theme-dot');
                
                // ä¸ºæ¯ä¸ªæŒ‰é’®å®šä¹‰åŠŸèƒ½
                const buttonFunctions = [
                    () => this.toggleBackgroundMode(), // ç¬¬ä¸€ä¸ªæŒ‰é’®ï¼šèƒŒæ™¯æ¨¡å¼åˆ‡æ¢
                    () => this.cycleIrisTheme(),       // ç¬¬äºŒä¸ªæŒ‰é’®ï¼šè™¹è†œä¸»é¢˜å¾ªç¯
                    () => this.toggleAnimationMode(),  // ç¬¬ä¸‰ä¸ªæŒ‰é’®ï¼šåŠ¨ç”»æ¨¡å¼åˆ‡æ¢
                    () => this.randomizeExpression()   // ç¬¬å››ä¸ªæŒ‰é’®ï¼šéšæœºè¡¨æƒ…
                ];
                
                themeDots.forEach((dot, index) => {
                    // æ·»åŠ æŒ‰é’®æ ‡è¯†
                    dot.setAttribute('data-function', ['background', 'iris', 'animation', 'random'][index]);
                    
                    dot.addEventListener('click', () => {
                        // æ‰§è¡Œå¯¹åº”åŠŸèƒ½
                        if (buttonFunctions[index]) {
                            buttonFunctions[index]();
                        }
                        
                        // ä¸´æ—¶é«˜äº®æ•ˆæœ
                        dot.classList.add('active');
                        setTimeout(() => {
                            if (!dot.classList.contains('permanent-active')) {
                                dot.classList.remove('active');
                            }
                        }, 500);
                    });
                    
                    dot.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            dot.click();
                        }
                    });
                });
            }
            
            toggleBackgroundMode() {
                const currentIndex = this.backgroundModes.indexOf(this.currentBackgroundMode);
                const nextIndex = (currentIndex + 1) % this.backgroundModes.length;
                this.currentBackgroundMode = this.backgroundModes[nextIndex];
                
                const body = document.body;
                // æ¸…é™¤æ‰€æœ‰èƒŒæ™¯æ¨¡å¼ç±»
                body.className = body.className.replace(/bg-mode-\w+/g, '');
                
                // æ·»åŠ æ–°çš„èƒŒæ™¯æ¨¡å¼ç±»ï¼ˆé™¤äº†defaultï¼‰
                if (this.currentBackgroundMode !== 'default') {
                    body.classList.add(`bg-mode-${this.currentBackgroundMode}`);
                }
            }
            
            cycleIrisTheme() {
                const currentIndex = this.irisThemes.indexOf(this.currentIrisTheme);
                const nextIndex = (currentIndex + 1) % this.irisThemes.length;
                this.currentIrisTheme = this.irisThemes[nextIndex];
                
                this.applyIrisTheme(this.currentIrisTheme);
            }
            
            toggleAnimationMode() {
                this.animationEnabled = !this.animationEnabled;
                const button = document.querySelector('[data-function="animation"]');
                
                if (this.animationEnabled) {
                    // å¯ç”¨åŠ¨ç”»æ¨¡å¼
                    button.classList.add('permanent-active');
                    button.style.backgroundColor = '#4ade80'; // ç»¿è‰²è¡¨ç¤ºå¯ç”¨
                    this.restartBlinking(); // é‡æ–°å¯åŠ¨çœ¨çœ¼åŠ¨ç”»
                    
                    // æ˜¾ç¤ºå¯ç”¨æç¤º
                    this.showModeIndicator('åŠ¨ç”»å·²å¯ç”¨', '#4ade80');
                } else {
                    // ç¦ç”¨åŠ¨ç”»æ¨¡å¼
                    button.classList.remove('permanent-active');
                    button.style.backgroundColor = '#ef4444'; // çº¢è‰²è¡¨ç¤ºç¦ç”¨
                    this.stopBlinking(); // åœæ­¢çœ¨çœ¼åŠ¨ç”»
                    
                    // æ˜¾ç¤ºç¦ç”¨æç¤º
                    this.showModeIndicator('åŠ¨ç”»å·²ç¦ç”¨', '#ef4444');
                }
            }
            
            // æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢æŒ‡ç¤ºå™¨
            showModeIndicator(text, color) {
                // åˆ›å»ºä¸´æ—¶æŒ‡ç¤ºå™¨
                const indicator = document.createElement('div');
                indicator.textContent = text;
                indicator.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${color};
                    color: white;
                    padding: 8px 16px;
                    border-radius: 20px;
                    font-size: 14px;
                    font-weight: 500;
                    z-index: 1000;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                
                document.body.appendChild(indicator);
                
                // æ˜¾ç¤ºåŠ¨ç”»
                setTimeout(() => {
                    indicator.style.opacity = '1';
                }, 10);
                
                // è‡ªåŠ¨ç§»é™¤
                setTimeout(() => {
                    indicator.style.opacity = '0';
                    setTimeout(() => {
                        if (indicator.parentNode) {
                            indicator.parentNode.removeChild(indicator);
                        }
                    }, 300);
                }, 2000);
            }
            
            randomizeExpression() {
                const expressions = ['happy', 'sad', 'surprised', 'angry', 'neutral'];
                const randomExpression = expressions[Math.floor(Math.random() * expressions.length)];
                this.setExpression(randomExpression);
                
                // æ·»åŠ éšæœºé¢œè‰²æ•ˆæœ
                this.faceElement.style.animation = 'color-shift 1s ease';
                setTimeout(() => {
                    this.faceElement.style.animation = 'none';
                }, 1000);
            }
            
            // é”®ç›˜æ§åˆ¶è®¾ç½®
            setupKeyboardControls() {
                document.addEventListener('keydown', (e) => {
                    switch (e.key) {
                        case '1': this.setExpression('neutral'); break;
                        case '2': this.setExpression('happy'); break;
                        case '3': this.setExpression('surprised'); break;
                        case '4': this.setExpression('sad'); break;
                        case '5': this.setExpression('laugh'); break;
                        case '6': this.applyIrisTheme('blue'); break;
                        case '7': this.applyIrisTheme('green'); break;
                        case '8': this.applyIrisTheme('brown'); break;
                        case '9': this.applyIrisTheme('gray'); break;
                        case ' ': 
                            e.preventDefault();
                            this.randomExpression();
                            break;
                    }
                });
            }
        }
        
        // åˆå§‹åŒ–è¡¨æƒ…ç®¡ç†å™¨
        document.addEventListener('DOMContentLoaded', () => {
            new EmotionManager();
        });
    </script>
</body>
</html>